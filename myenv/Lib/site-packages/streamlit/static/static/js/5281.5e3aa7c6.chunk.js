"use strict";(self.webpackChunk_streamlit_app=self.webpackChunk_streamlit_app||[]).push([[5281],{3727:(e,t,i)=>{i.d(t,{A:()=>c,o:()=>p});var s=i(58878),n=i(8151),l=i(70766),r=i(35331),a=i(58144),o=i(84152),d=i(90782);let p;!function(e){e.EXTRASMALL="xs",e.SMALL="sm",e.MEDIUM="md",e.LARGE="lg",e.EXTRALARGE="xl"}(p||(p={}));const c=function(e){let{value:t,width:i,size:c=p.SMALL,overrides:g}=e;const h=(0,n.u)(),u={xs:h.spacing.twoXS,sm:h.spacing.sm,md:h.spacing.lg,lg:h.spacing.xl,xl:h.spacing.twoXL},{activeTheme:m}=s.useContext(o.n),f=!(0,a.tl)(m),x={BarContainer:{style:{marginTop:h.spacing.none,marginBottom:h.spacing.none,marginRight:h.spacing.none,marginLeft:h.spacing.none}},Bar:{style:e=>{let{$theme:t}=e;return{width:i?i.toString():void 0,marginTop:h.spacing.none,marginBottom:h.spacing.none,marginRight:h.spacing.none,marginLeft:h.spacing.none,height:u[c],backgroundColor:t.colors.progressbarTrackFill,borderTopLeftRadius:h.spacing.twoXS,borderTopRightRadius:h.spacing.twoXS,borderBottomLeftRadius:h.spacing.twoXS,borderBottomRightRadius:h.spacing.twoXS}}},BarProgress:{style:()=>({backgroundColor:f?h.colors.primary:h.colors.blue70,borderTopLeftRadius:h.spacing.twoXS,borderTopRightRadius:h.spacing.twoXS,borderBottomLeftRadius:h.spacing.twoXS,borderBottomRightRadius:h.spacing.twoXS})}};return(0,d.jsx)(l.A,{value:t,overrides:(0,r.Qp)(x,g)})}},9830:(e,t,i)=>{i.d(t,{m:()=>s});class s{setStatus(e){return new s(this.name,this.size,this.id,e)}constructor(e,t,i,s){this.name=void 0,this.size=void 0,this.status=void 0,this.id=void 0,this.name=e,this.size=t,this.id=i,this.status=s}}},55281:(e,t,i)=>{i.r(t),i.d(t,{default:()=>he});var s=i(58878),n=i(32782),l=i(71034),r=i.n(l),a=i(50609),o=i.n(a),d=i(25571),p=i(29669),c=i(34752);let g;!function(e){e.Gigabyte="gb",e.Megabyte="mb",e.Kilobyte="kb",e.Byte="b"}(g||(g={}));const h=(0,d.Q2)()?1024:1e3,u=[g.Gigabyte,g.Megabyte,g.Kilobyte,g.Byte],m=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t||(t=g.Byte),i<0&&(i=0),e<0)throw new Error("Size must be greater than or equal to 0");const s=u.indexOf(t);return s&&e>h/2?m(e/h,u[s-1],i):`${e.toFixed(i)}${t.toUpperCase()}`};var f=i(70474),x=i(78286),w=i(93480),y=i(997),b=i(97779),F=i(36459),S=i(84720),v=i(89653);const I=(0,v.A)("section",{target:"e1b2p2ww15"})((e=>{let{isDisabled:t,theme:i}=e;return{display:"flex",alignItems:"center",padding:i.spacing.lg,backgroundColor:i.colors.secondaryBg,borderRadius:i.radii.default,":focus":{outline:"none"},":focus-visible":{boxShadow:`0 0 0 1px ${i.colors.primary}`},color:t?i.colors.gray:i.colors.bodyText}}),""),j=(0,v.A)("div",{target:"e1b2p2ww14"})({name:"9xni5b",styles:"margin-right:auto;align-items:center;display:flex"}),U=(0,v.A)("span",{target:"e1b2p2ww13"})((e=>{let{theme:t}=e;return{color:t.colors.darkenedBgMix100,marginRight:t.spacing.lg}}),""),A=(0,v.A)("span",{target:"e1b2p2ww12"})((e=>{let{theme:t}=e;return{marginBottom:t.spacing.twoXS}}),""),L=(0,v.A)("div",{target:"e1b2p2ww11"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),z=(0,v.A)("div",{target:"e1b2p2ww10"})((e=>{let{theme:t}=e;return{left:0,right:0,lineHeight:t.lineHeights.tight,paddingTop:t.spacing.md,paddingLeft:t.spacing.lg,paddingRight:t.spacing.lg}}),""),M=(0,v.A)("ul",{target:"e1b2p2ww9"})((e=>{let{theme:t}=e;return{listStyleType:"none",marginBottom:t.spacing.none}}),""),C=(0,v.A)("li",{target:"e1b2p2ww8"})((e=>{let{theme:t}=e;return{margin:t.spacing.none,padding:t.spacing.none}}),""),B=(0,v.A)("div",{target:"e1b2p2ww7"})((e=>{let{theme:t}=e;return{display:"flex",alignItems:"baseline",flex:1,paddingLeft:t.spacing.lg,overflow:"hidden"}}),""),X=(0,v.A)("div",{target:"e1b2p2ww6"})((e=>{let{theme:t}=e;return{marginRight:t.spacing.sm,marginBottom:t.spacing.twoXS,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),""),R=(0,v.A)("div",{target:"e1b2p2ww5"})((e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",marginBottom:t.spacing.twoXS}}),""),k=(0,v.A)("span",{target:"e1b2p2ww4"})((e=>{let{theme:t}=e;return{marginRight:t.spacing.twoXS}}),""),D=(0,v.A)("div",{target:"e1b2p2ww3"})((e=>{let{theme:t}=e;return{display:"flex",padding:t.spacing.twoXS,color:t.colors.darkenedBgMix100}}),""),T=(0,v.A)("small",{target:"e1b2p2ww2"})((e=>{let{theme:t}=e;return{color:t.colors.danger,fontSize:t.fontSizes.sm,height:t.fontSizes.sm,lineHeight:t.fontSizes.sm,display:"flex",alignItems:"center",whiteSpace:"nowrap"}}),""),E=(0,v.A)("span",{target:"e1b2p2ww1"})({name:"0",styles:""}),P=e=>({[I]:{display:"flex",flexDirection:"column",alignItems:"flex-start"},[j]:{marginBottom:e.spacing.lg},[U]:{display:"none"},[z]:{paddingRight:e.spacing.lg},[R]:{maxWidth:"inherit",flex:1,alignItems:"flex-start",marginBottom:e.spacing.sm},[X]:{width:e.sizes.full},[B]:{flexDirection:"column"},[T]:{height:"auto",whiteSpace:"initial"},[E]:{display:"none"},[C]:{margin:e.spacing.none,padding:e.spacing.none}}),V=(0,v.A)("div",{target:"e1b2p2ww0"})((e=>{let{theme:t}=e;return t.inSidebar?P(t):{[`@media (max-width: ${t.breakpoints.sm})`]:P(t)}}),"");var N=i(72718),$=i(64611),W=i(12978),H=i(90782);const O=e=>{let{multiple:t,acceptedExtensions:i,maxSizeBytes:s}=e;return(0,H.jsxs)(j,{"data-testid":"stFileUploaderDropzoneInstructions",children:[(0,H.jsx)(U,{children:(0,H.jsx)($.A,{content:N.b,size:"threeXL"})}),(0,H.jsxs)(L,{children:[(0,H.jsxs)(A,{children:["Drag and drop file",t?"s":""," here"]}),(0,H.jsxs)(W.O,{children:[`Limit ${m(s,g.Byte,0)} per file`,i.length?` \u2022 ${i.map((e=>e.replace(/^\./,"").toUpperCase())).join(", ")}`:null]})]})]})},_=e=>{let{onDrop:t,multiple:i,acceptedExtensions:s,maxSizeBytes:n,disabled:l,label:r}=e;return(0,H.jsx)(b.Ay,{onDrop:t,multiple:i,accept:s.length?s:void 0,maxSize:n,disabled:l,useFsAccessApi:!1,children:e=>{let{getRootProps:t,getInputProps:a}=e;return(0,H.jsxs)(I,{...t(),"data-testid":"stFileUploaderDropzone",isDisabled:l,"aria-label":r,children:[(0,H.jsx)("input",{"data-testid":"stFileUploaderDropzoneInput",...a()}),(0,H.jsx)(O,{multiple:i,acceptedExtensions:s,maxSizeBytes:n}),(0,H.jsx)(F.Ay,{kind:S.KX.SECONDARY,disabled:l,size:S.Pj.SMALL,children:"Browse files"})]})}})};var K=i(53124),G=i.n(K),q=i(35526),Q=i(77434),Y=i(76370);const Z=(0,v.A)("div",{target:"e1nlpozb1"})((e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:t.spacing.twoXS,marginBottom:t.spacing.twoXS}}),""),J=(0,v.A)("div",{target:"e1nlpozb0"})((e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",justifyContent:"center",color:t.colors.fadedText40}}),""),ee=e=>{let{currentPage:t,totalPages:i,onNext:s,onPrevious:n}=e;return(0,H.jsxs)(Z,{"data-testid":"stFileUploaderPagination",children:[(0,H.jsx)(W.O,{children:`Showing page ${t} of ${i}`}),(0,H.jsxs)(J,{children:[(0,H.jsx)(F.Ay,{onClick:n,kind:S.KX.MINIMAL,children:(0,H.jsx)($.A,{content:Q.J,size:"xl"})}),(0,H.jsx)(F.Ay,{onClick:s,kind:S.KX.MINIMAL,children:(0,H.jsx)($.A,{content:Y.c,size:"xl"})})]})]})},te=(e,t)=>Math.ceil(e.length/t),ie=e=>G()((t=>{let{pageSize:i,items:n,resetOnAdd:l,...r}=t;const[a,o]=(0,s.useState)(0),[d,p]=(0,s.useState)(te(n,i)),c=(0,q.Z)(n);(0,s.useEffect)((()=>{c&&c.length!==n.length&&p(te(n,i)),c&&c.length<n.length?l&&o(0):a+1>=d&&o(d-1)}),[n,a,i,c,l,d]);const g=n.slice(a*i,a*i+i);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(e,{items:g,...r}),n.length>i?(0,H.jsx)(ee,{pageSize:i,totalPages:d,currentPage:a+1,onNext:()=>{o(Math.min(a+1,d-1))},onPrevious:()=>{o(Math.max(0,a-1))}}):null]})}),e);var se=i(2742),ne=i(97522),le=i(64754),re=i(3727);const ae=e=>{let{fileInfo:t}=e;return"uploading"===t.status.type?(0,H.jsx)(re.A,{value:t.status.progress,size:re.o.SMALL}):"error"===t.status.type?(0,H.jsxs)(T,{children:[(0,H.jsx)(k,{"data-testid":"stFileUploaderFileErrorMessage",children:t.status.errorMessage}),(0,H.jsx)(E,{children:(0,H.jsx)($.A,{content:se.$,size:"lg"})})]}):"uploaded"===t.status.type?(0,H.jsx)(W.O,{children:m(t.size,g.Byte)}):null},oe=e=>{let{fileInfo:t,onDelete:i}=e;return(0,H.jsxs)(R,{className:"stFileUploaderFile","data-testid":"stFileUploaderFile",children:[(0,H.jsx)(D,{children:(0,H.jsx)($.A,{content:ne.i,size:"twoXL"})}),(0,H.jsxs)(B,{className:"stFileUploaderFileData",children:[(0,H.jsx)(X,{className:"stFileUploaderFileName","data-testid":"stFileUploaderFileName",title:t.name,children:t.name}),(0,H.jsx)(ae,{fileInfo:t})]}),(0,H.jsx)("div",{"data-testid":"stFileUploaderDeleteBtn",children:(0,H.jsx)(F.Ay,{onClick:()=>i(t.id),kind:S.KX.MINIMAL,children:(0,H.jsx)($.A,{content:le.k,size:"lg"})})})]})},de=ie((e=>{let{items:t,onDelete:i}=e;return(0,H.jsx)(M,{children:t.map((e=>(0,H.jsx)(C,{children:(0,H.jsx)(oe,{fileInfo:e,onDelete:i})},e.id)))})})),pe=e=>(0,H.jsx)(z,{children:(0,H.jsx)(de,{...e})});var ce=i(9830);class ge extends s.PureComponent{constructor(e){super(e),this.formClearHelper=new c.o,this.localFileIdCounter=1,this.forceUpdatingStatus=!1,this.componentDidUpdate=()=>{if("ready"!==this.status)return;const e=this.createWidgetValue(),{element:t,widgetMgr:i,fragmentId:s}=this.props,n=i.getFileUploaderStateValue(t);r()(e,n)||i.setFileUploaderStateValue(t,e,{fromUi:!0},s)},this.reset=()=>{this.setState({files:[]})},this.dropHandler=(e,t)=>{const{element:i}=this.props,{multipleFiles:s}=i;if(!s&&0===e.length&&t.length>1){const i=t.findIndex((e=>1===e.errors.length&&"too-many-files"===e.errors[0].code));i>=0&&(e.push(t[i].file),t.splice(i,1))}if(this.props.uploadClient.fetchFileURLs(e).then((t=>{if(!s&&e.length>0){const e=this.state.files.find((e=>"error"!==e.status.type));e&&(this.forceUpdatingStatus=!0,this.deleteFile(e.id),this.forceUpdatingStatus=!1)}o()(t,e).forEach((e=>{let[t,i]=e;this.uploadFile(t,i)}))})).catch((t=>{this.addFiles(e.map((e=>new ce.m(e.name,e.size,this.nextLocalFileId(),{type:"error",errorMessage:t}))))})),t.length>0){const e=t.map((e=>{const{file:t}=e;return new ce.m(t.name,t.size,this.nextLocalFileId(),{type:"error",errorMessage:this.getErrorMessage(e.errors[0].code,e.file)})}));this.addFiles(e)}},this.uploadFile=(e,t)=>{const i=n.A.CancelToken.source(),s=new ce.m(t.name,t.size,this.nextLocalFileId(),{type:"uploading",cancelToken:i,progress:1});this.addFile(s),this.props.uploadClient.uploadFile(this.props.element,e.uploadUrl,t,(e=>this.onUploadProgress(e,s.id)),i.token).then((()=>this.onUploadComplete(s.id,e))).catch((e=>{n.A.isCancel(e)||this.updateFile(s.id,s.setStatus({type:"error",errorMessage:e?e.toString():"Unknown error"}))}))},this.onUploadComplete=(e,t)=>{const i=this.getFile(e);(0,d.hX)(i)||"uploading"!==i.status.type||this.updateFile(i.id,i.setStatus({type:"uploaded",fileId:t.fileId,fileUrls:t}))},this.getErrorMessage=(e,t)=>{switch(e){case"file-too-large":return`File must be ${m(this.maxUploadSizeInBytes,g.Byte)} or smaller.`;case"file-invalid-type":return`${t.type} files are not allowed.`;case"file-too-small":return"File size is too small.";case"too-many-files":return"Only one file is allowed.";default:return"Unexpected error. Please try again."}},this.deleteFile=e=>{const t=this.getFile(e);(0,d.hX)(t)||("uploading"===t.status.type&&t.status.cancelToken.cancel(),"uploaded"===t.status.type&&t.status.fileUrls.deleteUrl&&this.props.uploadClient.deleteFile(t.status.fileUrls.deleteUrl),this.removeFile(e))},this.addFile=e=>{this.setState((t=>({files:[...t.files,e]})))},this.addFiles=e=>{this.setState((t=>({files:[...t.files,...e]})))},this.removeFile=e=>{this.setState((t=>({files:t.files.filter((t=>t.id!==e))})))},this.getFile=e=>this.state.files.find((t=>t.id===e)),this.updateFile=(e,t)=>{this.setState((i=>({files:i.files.map((i=>i.id===e?t:i))})))},this.onUploadProgress=(e,t)=>{const i=this.getFile(t);if((0,d.hX)(i)||"uploading"!==i.status.type)return;const s=Math.round(100*e.loaded/e.total);i.status.progress!==s&&this.updateFile(t,i.setStatus({type:"uploading",cancelToken:i.status.cancelToken,progress:s}))},this.onFormCleared=()=>{this.setState({files:[]},(()=>{const e=this.createWidgetValue();if((0,d.hX)(e))return;const{widgetMgr:t,element:i,fragmentId:s}=this.props;t.setFileUploaderStateValue(i,e,{fromUi:!0},s)}))},this.state=this.initialValue}get initialValue(){const e={files:[],newestServerFileId:0},{widgetMgr:t,element:i}=this.props,s=t.getFileUploaderStateValue(i);if((0,d.hX)(s))return e;const{uploadedFileInfo:n}=s;return(0,d.hX)(n)||0===n.length?e:{files:n.map((e=>{const t=e.name,i=e.size,s=e.fileId,n=e.fileUrls;return new ce.m(t,i,this.nextLocalFileId(),{type:"uploaded",fileId:s,fileUrls:n})}))}}componentWillUnmount(){this.formClearHelper.disconnect()}get maxUploadSizeInBytes(){return((e,t,i)=>{if(e<0)throw Error("Size must be 0 or greater");const s=u.findIndex((e=>e===t)),n=u.findIndex((e=>e===i));if(-1===s||-1===n)throw Error("Unexpected byte unit provided");if(s===n)return e;const l=Math.abs(s-n),r=h**l;return s>n?e/r:e*r})(this.props.element.maxUploadSizeMb,g.Megabyte,g.Byte)}get status(){return this.state.files.some((e=>"uploading"===e.status.type))||this.forceUpdatingStatus?"updating":"ready"}componentDidMount(){const e=this.createWidgetValue(),{element:t,widgetMgr:i,fragmentId:s}=this.props;void 0===i.getFileUploaderStateValue(t)&&i.setFileUploaderStateValue(t,e,{fromUi:!1},s)}createWidgetValue(){const e=this.state.files.filter((e=>"uploaded"===e.status.type)).map((e=>{const{name:t,size:i,status:s}=e,{fileId:n,fileUrls:l}=s;return new p.HY({fileId:n,fileUrls:l,name:t,size:i})}));return new p.qX({uploadedFileInfo:e})}render(){var e;const{files:t}=this.state,{element:i,disabled:s,widgetMgr:n}=this.props,l=i.type;this.formClearHelper.manageFormClearListener(n,i.formId,this.onFormCleared);const r=t.slice().reverse();return(0,H.jsxs)(V,{className:"stFileUploader","data-testid":"stFileUploader",children:[(0,H.jsx)(f.L,{label:i.label,disabled:s,labelVisibility:(0,d.yv)(null===(e=i.labelVisibility)||void 0===e?void 0:e.value),children:i.help&&(0,H.jsx)(x.j,{children:(0,H.jsx)(w.A,{content:i.help,placement:y.W.TOP_RIGHT})})}),(0,H.jsx)(_,{onDrop:this.dropHandler,multiple:i.multipleFiles,acceptedExtensions:l,maxSizeBytes:this.maxUploadSizeInBytes,label:i.label,disabled:s}),r.length>0&&(0,H.jsx)(pe,{items:r,pageSize:3,onDelete:this.deleteFile,resetOnAdd:!0})]})}nextLocalFileId(){return this.localFileIdCounter++}}const he=ge},34752:(e,t,i)=>{i.d(t,{X:()=>r,o:()=>l});var s=i(58878),n=i(25571);class l{constructor(){this.formClearListener=void 0,this.lastWidgetMgr=void 0,this.lastFormId=void 0}manageFormClearListener(e,t,i){(0,n.se)(this.formClearListener)&&this.lastWidgetMgr===e&&this.lastFormId===t||(this.disconnect(),(0,n._L)(t)&&(this.formClearListener=e.addFormClearedListener(t,i),this.lastWidgetMgr=e,this.lastFormId=t))}disconnect(){var e;null===(e=this.formClearListener)||void 0===e||e.disconnect(),this.formClearListener=void 0,this.lastWidgetMgr=void 0,this.lastFormId=void 0}}function r(e){let{element:t,widgetMgr:i,onFormCleared:l}=e;(0,s.useEffect)((()=>{if(!(0,n._L)(t.formId))return;const e=i.addFormClearedListener(t.formId,l);return()=>{e.disconnect()}}),[t,i,l])}},35526:(e,t,i)=>{i.d(t,{Z:()=>n});var s=i(58878);const n=e=>{const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=e}),[e]),t.current}}}]);